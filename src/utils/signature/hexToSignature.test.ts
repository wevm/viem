import { expect, test } from 'vitest'

import { toHex } from '../../utils/encoding/toHex.js'

import { hexToSignature } from './hexToSignature.js'

test('default', () => {
  expect(
    hexToSignature(
      '0x6e100a352ec6ad1b70802290e18aeed190704973570f3b8ed42cb9808e2ea6bf4a90a229a244495b41890987806fcbd2d5d23fc0dbe5f5256c2613c039d76db81c',
    ),
  ).toEqual({
    r: toHex(
      49782753348462494199823712700004552394425719014458918871452329774910450607807n,
    ),
    s: toHex(
      33726695977844476214676913201140481102225469284307016937915595756355928419768n,
    ),
    v: 28n,
    yParity: 1,
  })

  expect(
    hexToSignature(
      '0x6e100a352ec6ad1b70802290e18aeed190704973570f3b8ed42cb9808e2ea6bf4a90a229a244495b41890987806fcbd2d5d23fc0dbe5f5256c2613c039d76db81b',
    ),
  ).toEqual({
    r: toHex(
      49782753348462494199823712700004552394425719014458918871452329774910450607807n,
    ),
    s: toHex(
      33726695977844476214676913201140481102225469284307016937915595756355928419768n,
    ),
    v: 27n,
    yParity: 0,
  })

  expect(
    hexToSignature(
      '0x602381e57b70f1ada20bd56a806291cfc5cb5088f00f0e791510fd8b8cf05cc40dea7b983e0c7d204f3dc511b1f19a2787a5c82cd72f3bd38da58f10969907841b',
    ),
  ).toEqual({
    r: '0x602381e57b70f1ada20bd56a806291cfc5cb5088f00f0e791510fd8b8cf05cc4',
    s: '0x0dea7b983e0c7d204f3dc511b1f19a2787a5c82cd72f3bd38da58f1096990784',
    v: 27n,
    yParity: 0,
  })
})
